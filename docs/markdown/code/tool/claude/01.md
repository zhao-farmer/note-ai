
# 一、初始化Claude

## 1.1 引言

### 1.1.1 为什么不用Cursor了

​	Cursor是一款基于人工智能的代码编辑器，旨在帮助开发人员编写代码，并于AI进行实时互动，提供写代码建议、错误检测和自动补全功能。支持多种编程语言（如Python、JavaScript、Java等）

​	现在AI开发工具在开发中的能力和重要性越来越高，Cursor的高能力让很多人趋之若鹜，但是Cursor计价规则的**黑箱模式**、朝令夕改、费用上调又让开发者们感到无奈且遗憾。

​	Cursor首先是修改了免费用户的使用权限，从不限制模型到只能使用gpt4.1模型，再到只能使用Auto模式；其次修改了每个月充值了 20美元的Pro用户的权限，首先是从每月500次快速，额度用尽后转为慢速，变成了无次数限制，但是快速慢速混用，可以通过额外付费避免慢速。其实这倒是也能接受，无非是每天可能会有几个任务卡住几分钟或者十几分钟而已。但是最近一次的计费规则修改堪称抽象，Pro用户每月只能发起总价$20的请求。下图是我上个月的用量：

![](/code/tool/claude/001.png)

​	原来这些模型这么贵。那$20想必也是稍纵即逝。这种朝令夕改、不公布计价细节的行为让人无法接受，Cursor是其母公司的唯一产品，其并没有一线大厂的一言九鼎和尊重用户的品质，因此，选择一个合适的替代品十分重要

### 1.1.2 为什么使用Claude Code

​	Calude（克劳德）Code 是由 Anthropic 开发的官方 CLI 工具，用于协助用户处理软件工程任务。 Anthropic 发现了Cursor的成功后，开发了Claude Code作为Cursor的竞品。Claude Code是一个革命性的AI编程工具，它将强大的Claude AI直接集成到您的开发环境中。

```
Anthropic是一家位于美国加州旧金山的人工智能股份有限公司，成立于2021年。该公司是一家人工智能安全和研究公司，致力于构建可靠、可解释和可操纵的AI系统。Anthropic公司开发了聊天机器人Claude，提出的“宪法AI原则”。 
2025年2月25日，Anthropic宣布推出Claude 3.7 Sonnet，称这是其迄今为止最智能的模型，也是市场上首款混合推理模型。北京时间2025年5月23日，Anthropic正式推出Claude 4系列大模型。
2025年4月，入选《2025福布斯AI 50榜单》
```

与传统的代码编辑器插件不同，Claude Code在终端中运行，具有以下特点：

* 智能代码理解: 深度理解您的项目结构和代码逻辑
* 自然语言交互: 用普通话描述需求，AI自动执行编程任务
* 全项目上下文: 理解整个代码库的架构和依赖关系
* 安全可靠: 直接连接Anthropic API，所有操作在本地执行
* Git集成: 智能的版本控制操作和历史分析

除此之外，Claude Code还有以下优势：

- 原生Claude模型，没有Cursor暗加的种种故意为了耗费提问次数的提示词，能按照需求制定完善的执行计划
- 可按token计费，而不是提问次数。这样无论问题大小尽管提问，按需付费。
- 可接入其他模型，这是很重要的一点，因为只要是符合Anthropic框架的LLM都可以接入Claude Code平台
- 安装简单，调用国内最新模型价格低廉。后续会详细说明安装流程

### 1.1.3 应用场景举例

```shell
# 场景一：代码编写和修改
"添加一个用户登录功能"
"修复这个函数的bug"
"重构这段代码提高性能"

# 场景二：代码分析和理解
"这个项目是做什么的？"
"解释这个函数的工作原理"
"找出性能瓶颈在哪里"

# 场景三：测试和调试
"运行所有测试并修复失败的部分"
"添加单元测试覆盖这个模块"
"分析为什么这个测试失败了"

# 场景四：Git操作
"提交当前更改"
"创建新分支进行功能开发"
"查看最近的提交历史"

# 其他......
```

* 项目分析

![](/code/tool/claude/002.png)

* 添加功能

![](/code/tool/claude/003.png)

* 项目性能分析

![](/code/tool/claude/004.png)



## 1.2 Claude Code的安装

### 1.2.1 Kimi K2模型

​	KimiK2是北京月之暗面科技有限公司于2025年7月11日推出的模型，具备更强代码能力、更擅长通用Agent任务的MoE架构基础模型。Kimi K2继承了DeepSeek-V3的架构，并在后者基础上进行增加专家数量、减少注意力头数量等调整。号称代码能力与Agent能力强大，真实水平虽然并没有达到无比强大，但是做到了很棒的性价比

![](/code/tool/claude/005.png)

​	关于这里为什么提到了Kimi K2？在经常使用大模型的人眼中月之暗面的Kimi的存在感几乎为0，但是这一次它的新模型遵循Anthropic协议，这代表着其可以顺利接入Claude Code，并且无需任何路由代理，只需要配置好URL与API即可直接使用。

​	如果使用Anthropic的Claude服务的话，其实有很多困难的地方，虽然Claude的代码能力在全世界是毋庸置疑的遥遥领先，但是其并没有开放对中国大陆地区的服务，当检测到异常IP的话会给中国用户进行迅速封号（会把充值的钱原路返回）。因此如果需要使用其服务要么就是自己搭建一套稳定的海外中转站，要么从一些国内开发者搭建的镜像平台购买服务。外加上Claude服务的价格也不是很低，也要至少$20一个月。所以如果不是为了极致的性能和开发质量，我们可以接入Kimi K2实现一个向下兼容的替代。



### 1.2.2 Kimi 服务的配置

​	我们直接来到Moonshot官网获取自己的API key

[Moonshot AI - 开放平台](https://platform.moonshot.cn/console/api-keys)

新建API key。妥善保存，key不能二次查看

![](/code/tool/claude/006.png)

接下来将Moonshot的url以及API key设置进环境变量的系统变量中。

```
ANTHROPIC_API_KEY
你的API key
```

```
ANTHROPIC_BASE_URL
https://api.moonshot.cn/anthropic/
```

![](/code/tool/claude/007.png)


### 1.2.3 Claude Code 的安装

​	Claude Code的最新版本终于支持Windows系统了，不用再用wsl去进行繁琐的配置了！

```
WSL（Windows Subsystem for Linux）是微软开发的Windows子系统，允许用户在Windows 10/11上原生运行Linux二进制文件，无需虚拟机或双系统启动。
```

在开始之前，需要确保系统满足以下要求：

#### 1.2.3.1 必备组件

- Windows 10 版本 2004 及以上（Build 19041+）或 Windows 11
- 管理员权限
- Git 版本控制工具
- Node.js 18+ 版本（推荐使用最新LTS版本）
- 稳定的网络连接
- 终端功能，比如使用 iTerm2、Windows Terminal 等（非必须）

#### 1.2.3.2 安装claude-code

1. 通过npm包管理器直接安装

    ```bash
    npm install -g @anthropic-ai/claude-code
    ```

2. 安装完成后验证是否安装成功

    ```bash
    claude --version
    ```

    ![](/code/tool/claude/008.png)


3. 启动网络代理服务

    在启动之前需要启动一下网络的代理服务，因为如果识别到国内网络环境会禁止登录。

    开启 Shadowsocks 的全局模式


4. 开启代理服务

    在开启代理服务后还需要在当前终端中输入以下配置，为让cmd也能使用代理服务。

    ```bash
    set http_proxy=http://127.0.0.1:1080
    set https_proxy=https://127.0.0.1:1080
    ```

5. 启动后首先选择颜色配置

    - 控制台输入

        ```sh
        claude
        ```
    - 选择主题

        注意：这个过程需要科学上网，具体参考文档
        
        ![](/code/tool/claude/009.png)

6. 登录

    1. 之后是登陆方式，选择第二种，会自动从环境变量中寻找配置信息登陆进去

        ![](/code/tool/claude/010.png)

        >注意：这个过程需要有个验证过程，需要官网验证，参考文档

    2. 之后正常来说就可以进行使用了

        ![](/code/tool/claude/011.png)

        ​	如果这里显示并发数限制之类的**Error 429**报错，则是Kimi那边的问题。Kimi给每个用户提供了15元的免费额度，但是免费用户的并发数限制为1，这很可能导致不能正常使用。需要至少充值50元让用户等级从**free**到**Tier1**就可以解决这个问题。


        ![](/code/tool/claude/012.png)

## 1.3 Claude Code 简单入门

​	Claude是完全通过终端进行交互的，其中内置了多种工具，比如文件操作、搜索等。可以理解自然语言并转化为相应的命令执行。

### 1.3.1 启动Claude Code

```bash
# 在项目根目录启动
claude

# 或者在某个目录指定特定任务
claude "帮我分析这个项目的结构"
```

### 1.3.2 语言设置

在启动目录，创建文件夹.claude，在.claude文件夹中创建文件config.json

```json
{
  "model": "claude-3-5-sonnet-20241022",
  "max_tokens": 4000,
  "temperature": 0.7,
  "auto_approve": false,
  "git_integration": true,
  "excluded_files": [
    "node_modules/**",
    ".git/**",
    "*.log",
    "dist/**"
  ],
  "language_preferences": {
    "documentation": "zh-CN",
    "code_comments": "zh-CN"
  }
}
```

### 1.3.3 测试

* 比如说让其进入某个工作目录下：

![image-20250717161900665](./images/image-20250717161900665.png)

​	然后可以理解每一句自然语言并执行，其还有很多丰富的用法，比如Calude Code的一些命令、以及可以通过编写一个规范说明文档限制其行为等。以上是最方便简易的使用方式。

